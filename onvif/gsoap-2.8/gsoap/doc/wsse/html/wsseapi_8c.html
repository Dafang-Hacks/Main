<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>gSOAP WS-Security: /Users/engelen/Projects/gsoap/plugin/wsseapi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.4 -->
<div id="top">
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">gSOAP WS-Security&#160;<span id="projectnumber">2.8 Stable</span></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Defines</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">/Users/engelen/Projects/gsoap/plugin/wsseapi.c File Reference</div>  </div>
</div>
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="wsseapi_8h.html">wsseapi.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="smdevp_8h.html">smdevp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="mecevp_8h.html">mecevp.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="threads_8h.html">threads.h</a>&quot;</code><br/>
</div><div class="textblock"><div class="dynheader">
Include dependency graph for wsseapi.c:</div>
<div class="dyncontent">
<div class="center"><img src="wsseapi_8c__incl.png" border="0" usemap="#_2_users_2engelen_2_projects_2gsoap_2plugin_2wsseapi_8c" alt=""/></div>
<map name="_2_users_2engelen_2_projects_2gsoap_2plugin_2wsseapi_8c" id="_2_users_2engelen_2_projects_2gsoap_2plugin_2wsseapi_8c">
<area shape="rect" id="node3" href="wsseapi_8h.html" title="wsseapi.h" alt="" coords="108,83,188,111"/><area shape="rect" id="node7" href="smdevp_8h.html" title="smdevp.h" alt="" coords="4,161,83,189"/><area shape="rect" id="node11" href="mecevp_8h.html" title="mecevp.h" alt="" coords="202,161,280,189"/><area shape="rect" id="node16" href="threads_8h.html" title="threads.h" alt="" coords="295,83,371,111"/></map>
</div>
</div><table class="memberdecls">
<tr><td colspan="2"><h2><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsoap__wsse__session.html">soap_wsse_session</a></td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Digest authentication session data.  <a href="structsoap__wsse__session.html#details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2><a name="define-members"></a>
Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a5c6f8145831c10a4dbd0465a923908c6">SOAP_WSSE_MAX_REF</a>&#160;&#160;&#160;(100)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a12d6f49d99323ae66d2a6ee154f90469">SOAP_WSSE_CLKSKEW</a>&#160;&#160;&#160;(300)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a65c55be8ba01ac63f64fddbe0e82b75b">SOAP_WSSE_NONCELEN</a>&#160;&#160;&#160;(20)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a5de15cf324b79588e67e4ccbba2119ae">SOAP_WSSE_NONCETIME</a>&#160;&#160;&#160;(SOAP_WSSE_CLKSKEW + 240)</td></tr>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a3dafa97e60020d63fdd4be32aefa4119">soap_wsse_ids</a> (struct soap *soap, const char *tags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">converts tag name(s) to id name(s)  <a href="#a3dafa97e60020d63fdd4be32aefa4119"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#acb666de6b99187df159aaee8219317bd">soap_wsse_session_verify</a> (struct soap *soap, const char hash[SOAP_SMD_SHA1_SIZE], const char *created, const char *nonce)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies and updates the digest, nonce, and creation time against the digest authentication session database to prevent replay attacks.  <a href="#acb666de6b99187df159aaee8219317bd"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a0dd21015cab9811c9da9b08117401ad5">soap_wsse_session_cleanup</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Removes expired authentication data from the digest authentication session database.  <a href="#a0dd21015cab9811c9da9b08117401ad5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ae341110563279cc6f5cc57c22eaa7a8b">calc_digest</a> (struct soap *soap, const char *created, const char *nonce, int noncelen, const char *password, char hash[SOAP_SMD_SHA1_SIZE])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates digest value SHA1(created, nonce, password)  <a href="#ae341110563279cc6f5cc57c22eaa7a8b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a1c4fe3f38985fd0c526a03fdbafc2ad1">calc_nonce</a> (struct soap *soap, char nonce[SOAP_WSSE_NONCELEN])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates randomized nonce (also uses time() in case a poorly seeded PRNG is used)  <a href="#a1c4fe3f38985fd0c526a03fdbafc2ad1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ae9f8c9147cb058c0316f7f8c935a1b92">soap_wsse_init</a> (struct soap *soap, struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *data, const void *(*arg)(struct soap *, int *, const char *, int *))</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initializes plugin data.  <a href="#ae9f8c9147cb058c0316f7f8c935a1b92"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a491ec857faca76dce6ff59218e58626c">soap_wsse_copy</a> (struct soap *soap, struct soap_plugin *dst, struct soap_plugin *src)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies plugin data to localize plugin data for threads.  <a href="#a491ec857faca76dce6ff59218e58626c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a67455a9af65734dc71fa3e3bf66a6738">soap_wsse_delete</a> (struct soap *soap, struct soap_plugin *p)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes plugin data.  <a href="#a67455a9af65734dc71fa3e3bf66a6738"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aa3df0ea602c9868f5e1c7d636aeeddf9">soap_wsse_preparesend</a> (struct soap *soap, const char *buf, size_t len)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a piece of the XML message (tokenized) to compute digest.  <a href="#aa3df0ea602c9868f5e1c7d636aeeddf9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a0a65a4a97fc2ed131ef7a24da07ba08f">soap_wsse_preparefinalsend</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Collects the digests of all the wsu:Id elements and populates the SignedInfo.  <a href="#a0a65a4a97fc2ed131ef7a24da07ba08f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a9f2b5e6c2242b3516e624d1b2b25ee1e">soap_wsse_preparecleanup</a> (struct soap *soap, struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *data)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores engine state.  <a href="#a9f2b5e6c2242b3516e624d1b2b25ee1e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ae3558fa3952e01ec72fbd5f9bf4b1b37">soap_wsse_preparefinalrecv</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verify signature and SignedInfo digests initiated with soap_wsse_verify_auto.  <a href="#ae3558fa3952e01ec72fbd5f9bf4b1b37"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a278a5511160aade2c206b0225781ff04">soap_wsse_header</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is invoked as soon as the SOAP Header is received, we need to obtain the encrypted key when the message is encrypted to start decryption.  <a href="#a278a5511160aade2c206b0225781ff04"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a903b3f58fd8b9699751c703793f06435">soap_wsse_element_begin_in</a> (struct soap *soap, const char *tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is invoked as soon as a starting tag of an element is received by the XML parser.  <a href="#a903b3f58fd8b9699751c703793f06435"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ae095227834179806af2ea7dc90bd961e">soap_wsse_element_end_in</a> (struct soap *soap, const char *tag1, const char *tag2)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is invoked as soon as an ending tag of an element is received by the XML parser.  <a href="#ae095227834179806af2ea7dc90bd961e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad7924c5bd34781df563ed2339eab59f3">soap_wsse_element_begin_out</a> (struct soap *soap, const char *tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is invoked as soon as a starting tag of an element is to be sent by the XML generator.  <a href="#ad7924c5bd34781df563ed2339eab59f3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a04ac9993d22e7b868135f9b7ebcca8e0">soap_wsse_element_end_out</a> (struct soap *soap, const char *tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">This callback is invoked as soon as an ending tag of an element is to be sent by the XML generator.  <a href="#a04ac9993d22e7b868135f9b7ebcca8e0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#add4f5148c87d213a69f86c9fc72a8001">soap_wsse_verify_nested</a> (struct soap *soap, struct soap_dom_element *dom, const char *URI, const char *tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Counts signed matching elements from the dom node and down.  <a href="#add4f5148c87d213a69f86c9fc72a8001"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a6f167767a1a7763be6dc2b8eff75e419">soap_wsse_add_Security</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Security header element.  <a href="#a6f167767a1a7763be6dc2b8eff75e419"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aba5822fee3cafde84e4bcae41a37fc69">soap_wsse_add_Security_actor</a> (struct soap *soap, const char *actor)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Security header element with actor or role attribute.  <a href="#aba5822fee3cafde84e4bcae41a37fc69"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ac06c7021592b2aaca50f73e0de9dec7c">soap_wsse_delete_Security</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes Security header element.  <a href="#ac06c7021592b2aaca50f73e0de9dec7c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a5d9f35b53cbf1b94d7bc3fdfa1728485">soap_wsse_Security</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Security header element if present.  <a href="#a5d9f35b53cbf1b94d7bc3fdfa1728485"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a07b4f0c2995df0a695a6f06e2519151f">soap_wsse_add_Signature</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Signature header element.  <a href="#a07b4f0c2995df0a695a6f06e2519151f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad817f20012b39724f7351909b0b79df2">soap_wsse_delete_Signature</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes Signature header element.  <a href="#ad817f20012b39724f7351909b0b79df2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a4b8fe90c13170958dcee629a519c4451">soap_wsse_Signature</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Signature header element if present.  <a href="#a4b8fe90c13170958dcee629a519c4451"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a71fe27aee76db1d0a635afe106d8b109">soap_wsse_add_Timestamp</a> (struct soap *soap, const char *id, time_t lifetime)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds Timestamp element with optional expiration date+time (lifetime).  <a href="#a71fe27aee76db1d0a635afe106d8b109"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsu_____timestamp.html">_wsu__Timestamp</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a55271d6c4b775d88995a5e4837142b0f">soap_wsse_Timestamp</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns Timestamp element if present.  <a href="#a55271d6c4b775d88995a5e4837142b0f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a98422cde0e2b7b14d65212f7061101fa">soap_wsse_verify_Timestamp</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the Timestamp/Expires element against the current time.  <a href="#a98422cde0e2b7b14d65212f7061101fa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a37f32e51bceabf2e2823516a1737548f">soap_wsse_add_UsernameTokenText</a> (struct soap *soap, const char *id, const char *username, const char *password)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds UsernameToken element with optional clear-text password.  <a href="#a37f32e51bceabf2e2823516a1737548f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ac9fe59008bdf12d7a007ac48e6ebb613">soap_wsse_add_UsernameTokenDigest</a> (struct soap *soap, const char *id, const char *username, const char *password)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds UsernameToken element for digest authentication.  <a href="#ac9fe59008bdf12d7a007ac48e6ebb613"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsse_____username_token.html">_wsse__UsernameToken</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a6bde1e5babdeb24b2f88666a837d4c21">soap_wsse_UsernameToken</a> (struct soap *soap, const char *id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns UsernameToken element if present.  <a href="#a6bde1e5babdeb24b2f88666a837d4c21"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a936a081cece9995f265b885e113ff5db">soap_wsse_get_Username</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns UsernameToken/username string or wsse:FailedAuthentication fault.  <a href="#a936a081cece9995f265b885e113ff5db"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aeb0afd01a5036e4f1314a3cfe8575bd5">soap_wsse_verify_Password</a> (struct soap *soap, const char *password)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the supplied password or sets wsse:FailedAuthentication fault.  <a href="#aeb0afd01a5036e4f1314a3cfe8575bd5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a272ece3d02d7fbb5309cda9d1b252822">soap_wsse_add_BinarySecurityToken</a> (struct soap *soap, const char *id, const char *valueType, const unsigned char *data, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element.  <a href="#a272ece3d02d7fbb5309cda9d1b252822"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a53075fb3cec4ec4e70fb11850fecb401">soap_wsse_add_BinarySecurityTokenX509</a> (struct soap *soap, const char *id, X509 *cert)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element with X509 certificate.  <a href="#a53075fb3cec4ec4e70fb11850fecb401"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad88d8317bcbbcda4cdc8d1bcfb2e0f18">soap_wsse_add_BinarySecurityTokenPEM</a> (struct soap *soap, const char *id, const char *filename)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds BinarySecurityToken element from a PEM file.  <a href="#ad88d8317bcbbcda4cdc8d1bcfb2e0f18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct__wsse_____binary_security_token.html">_wsse__BinarySecurityToken</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ab0d5552252e672a0ea24af9b6595bd2c">soap_wsse_BinarySecurityToken</a> (struct soap *soap, const char *id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns BinarySecurityToken element if present.  <a href="#ab0d5552252e672a0ea24af9b6595bd2c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a7496da1dd76aa06e6657365b5c7dd76d">soap_wsse_get_BinarySecurityToken</a> (struct soap *soap, const char *id, char **valueType, unsigned char **data, int *size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get wsse:BinarySecurityToken element token data in binary form.  <a href="#a7496da1dd76aa06e6657365b5c7dd76d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">X509 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#af88b4ff21d348c6b256b72b600514e14">soap_wsse_get_BinarySecurityTokenX509</a> (struct soap *soap, const char *id)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get X509 wsse:BinarySecurityToken certificate and verify its content.  <a href="#af88b4ff21d348c6b256b72b600514e14"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a8f5879e7d5bd3580ea400ccd1982d747">soap_wsse_verify_X509</a> (struct soap *soap, X509 *cert)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies X509 certificate against soap-&gt;cafile, soap-&gt;capath, and soap-&gt;crlfile.  <a href="#a8f5879e7d5bd3580ea400ccd1982d747"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a4941ccab15e473e979ff4b3a926c04bb">soap_wsse_add_SecurityContextToken</a> (struct soap *soap, const char *id, const char *identifier)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds wsc:SecurityContextToken/Identifier and SecurityTokenReference to it.  <a href="#a4941ccab15e473e979ff4b3a926c04bb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a12a8109d64be5b5da7afd7679ed2e681">soap_wsse_get_SecurityContextToken</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns wsc:SecurityContextToken/Identifier string value or NULL.  <a href="#a12a8109d64be5b5da7afd7679ed2e681"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ab4a10d08044dd66da337f684385ed2cf">soap_wsse_add_SignedInfo</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element.  <a href="#ab4a10d08044dd66da337f684385ed2cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aa5ea0bcecf8f77929b70b4603d5d6a0e">soap_wsse_add_SignedInfo_Reference</a> (struct soap *soap, const char *URI, const char *transform, const char *inclusiveNamespaces, int alg, const char *HA)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element with Reference URI, transform algorithm used, and digest value.  <a href="#aa5ea0bcecf8f77929b70b4603d5d6a0e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a398f98d62dfba91d04cff19230fb6722">soap_wsse_add_SignedInfo_SignatureMethod</a> (struct soap *soap, const char *method, int canonical)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo element with SignatureMethod.  <a href="#a398f98d62dfba91d04cff19230fb6722"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a216e30bdddd04d328398126851d0f87a">soap_wsse_SignedInfo</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns SignedInfo element if present.  <a href="#a216e30bdddd04d328398126851d0f87a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#afd4c4268cc8f9d667cc44586fb635b5d">soap_wsse_get_SignedInfo_SignatureMethod</a> (struct soap *soap, int *alg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Get SignatureMethod algorithm.  <a href="#afd4c4268cc8f9d667cc44586fb635b5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a7399c40e0019bc1ae797fccf92f81fc7">soap_wsse_add_SignatureValue</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds SignedInfo/SignatureMethod element, signs the SignedInfo element, and adds the resulting SignatureValue element.  <a href="#a7399c40e0019bc1ae797fccf92f81fc7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a8ab7e709b0423cd68d3fec96b3db3734">soap_wsse_verify_SignatureValue</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the SignatureValue of a SignedInfo element.  <a href="#a8ab7e709b0423cd68d3fec96b3db3734"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a75b7ca484637dfc49143546072dd5f4b">soap_wsse_verify_SignedInfo</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the digest values of the XML elements referenced by the SignedInfo References.  <a href="#a75b7ca484637dfc49143546072dd5f4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#acf1c213ea26a2286f9c0457849bd6290">soap_wsse_verify_digest</a> (struct soap *soap, int alg, int canonical, const char *id, unsigned char hash[SOAP_SMD_MAX_SIZE])</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the digest value of an XML element referenced by id against the hash.  <a href="#acf1c213ea26a2286f9c0457849bd6290"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ac80606801677bc109bcef606655f6e23">soap_wsse_add_KeyInfo</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element.  <a href="#ac80606801677bc109bcef606655f6e23"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a3978578b5dd8dc7065e9946982fe7d57">soap_wsse_KeyInfo</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo element if present.  <a href="#a3978578b5dd8dc7065e9946982fe7d57"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a25240140007f1776479e81dd43457f40">soap_wsse_add_KeyInfo_KeyName</a> (struct soap *soap, const char *name)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyName element.  <a href="#a25240140007f1776479e81dd43457f40"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aeb7b82c21d0022bd1ac08c843cefe75f">soap_wsse_get_KeyInfo_KeyName</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyName element if present.  <a href="#aeb7b82c21d0022bd1ac08c843cefe75f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aa1557c59801a0c3e4a77c1cb56cc2d9e">soap_wsse_add_KeyInfo_SecurityTokenReferenceURI</a> (struct soap *soap, const char *URI, const char *valueType)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference URI.  <a href="#aa1557c59801a0c3e4a77c1cb56cc2d9e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a72df80abd1d36cea516feda3a84672cf">soap_wsse_add_KeyInfo_SecurityTokenReferenceX509</a> (struct soap *soap, const char *URI)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference URI to an X509 cert.  <a href="#a72df80abd1d36cea516feda3a84672cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aaf44a9fdec53a3a7ec2ff1a9dae6c51c">soap_wsse_get_KeyInfo_SecurityTokenReferenceURI</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a SecurityTokenReference URI if present.  <a href="#aaf44a9fdec53a3a7ec2ff1a9dae6c51c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad7f620007d3395a0e361495f2034492a">soap_wsse_get_KeyInfo_SecurityTokenReferenceValueType</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a SecurityTokenReference ValueType if present.  <a href="#ad7f620007d3395a0e361495f2034492a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">X509 *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#afeea66260af15add6e581e8dfc18361a">soap_wsse_get_KeyInfo_SecurityTokenReferenceX509</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns a X509 certificate if present as a BinarySecurity token.  <a href="#afeea66260af15add6e581e8dfc18361a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structds_____x509_issuer_serial_type.html">ds__X509IssuerSerialType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a458ef16bc2a6a93fab21bdfcbfc34d5d">soap_wsse_get_KeyInfo_SecurityTokenReferenceX509Data</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType.">ds__X509IssuerSerialType</a> with non-NULL X509IssuerName and non-NULL X509SerialNumber of a X509Data element when present and set.  <a href="#a458ef16bc2a6a93fab21bdfcbfc34d5d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a83ad7822556d691020209fa12d1c79a7">soap_wsse_add_KeyInfo_SecurityTokenReferenceKeyIdentifier</a> (struct soap *soap, const char *id, const char *valueType, unsigned char *data, int size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with SecurityTokenReference/KeyIdentifier binary data.  <a href="#a83ad7822556d691020209fa12d1c79a7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aa828d0c93226ca87c382a831fcdc703c">soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifierValueType</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo/SecurityTokenReference/KeyIdentifier/ValueType if present.  <a href="#aa828d0c93226ca87c382a831fcdc703c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#af7c3fc130e6925df8af8d004c925c008">soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifier</a> (struct soap *soap, int *size)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns KeyInfo/SecurityTokenReference/KeyIdentifier binary data.  <a href="#af7c3fc130e6925df8af8d004c925c008"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a8fcf5947eb011d73b6a6b1308123a536">soap_wsse_add_KeyInfo_SecurityTokenReferenceEmbedded</a> (struct soap *soap, const char *id, const char *valueType)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds KeyInfo element with Embedded SecurityTokenReference.  <a href="#a8fcf5947eb011d73b6a6b1308123a536"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a1ba85a8b14587cff0865ebc3e5e9e340">soap_wsse_add_EncryptedKey</a> (struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedKey header element and initiates the encryption of the SOAP Body.  <a href="#a1ba85a8b14587cff0865ebc3e5e9e340"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#adef816d148bd8b1ce1c5a3d023712779">soap_wsse_add_EncryptedKey_encrypt_only</a> (struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial, const char *tags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedKey header element and initiates encryption of the given XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags.  <a href="#adef816d148bd8b1ce1c5a3d023712779"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#afcfdd54e7c220fb90e11c75da3bbbe88">soap_wsse_verify_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Verifies the EncryptedKey header information (certificate validity requires soap-&gt;cacert to be set). Retrieves the decryption key from the token handler callback to decrypt the decryption key.  <a href="#afcfdd54e7c220fb90e11c75da3bbbe88"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad276cfcbd007515a6dce80c646e23ef5">soap_wsse_delete_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Deletes EncryptedKey header element.  <a href="#ad276cfcbd007515a6dce80c646e23ef5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structxenc_____encrypted_key_type.html">xenc__EncryptedKeyType</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a82fe0ee01741a65f835fa0ffaad0a157">soap_wsse_EncryptedKey</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns EncryptedKey header element if present.  <a href="#a82fe0ee01741a65f835fa0ffaad0a157"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aeec61121d56b2cf85e48997376c0b50a">soap_wsse_add_EncryptedKey_DataReferenceURI</a> (struct soap *soap, const char *URI)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a DataReference URI to the EncryptedKey header element.  <a href="#aeec61121d56b2cf85e48997376c0b50a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#acbd56e9f4e7da00b1db51bca3e4f226b">soap_wsse_add_DataReferenceURI</a> (struct soap *soap, const char *URI)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds a DataReference URI to the WS-Security header element.  <a href="#acbd56e9f4e7da00b1db51bca3e4f226b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a0569043138de574a8f61f45b608971ad">soap_wsse_add_EncryptedData_KeyInfo_KeyName</a> (struct soap *soap, const char *keyname)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Adds EncryptedData/ds:KeyInfo/Keyname elements.  <a href="#a0569043138de574a8f61f45b608971ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aac4234bd51599c36aec7bf7888191fb0">soap_wsse_sender_fault_subcode</a> (struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets sender SOAP Fault (sub)code for server fault response.  <a href="#aac4234bd51599c36aec7bf7888191fb0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a5cec82648247163c63a28d624b2b9fe8">soap_wsse_receiver_fault_subcode</a> (struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets receiver SOAP Fault (sub)code for server fault response.  <a href="#a5cec82648247163c63a28d624b2b9fe8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a0e7d820ea5bf71efb136bb7f0ffbb71f">soap_wsse_sender_fault</a> (struct soap *soap, const char *faultstring, const char *faultdetail)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets sender SOAP Fault for server fault response.  <a href="#a0e7d820ea5bf71efb136bb7f0ffbb71f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a7590c46443ff1c74365091d2d7806829">soap_wsse_receiver_fault</a> (struct soap *soap, const char *faultstring, const char *faultdetail)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets receiver SOAP Fault for server fault response.  <a href="#a7590c46443ff1c74365091d2d7806829"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a2d9787c17c1738314cfb3c2fc4aca3ff">soap_wsse_fault</a> (struct soap *soap, <a class="el" href="wsse_8h.html#aaade5f4816d66546a0817dade206f50f">wsse__FaultcodeEnum</a> fault, const char *detail)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets SOAP Fault (sub)code for server response.  <a href="#a2d9787c17c1738314cfb3c2fc4aca3ff"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#af15bedb61bffb589683354bc37d20c3a">soap_wsse</a> (struct soap *soap, struct soap_plugin *p, void *arg)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Plugin registry function, used with soap_register_plugin.  <a href="#af15bedb61bffb589683354bc37d20c3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aae73086424d1c8386d3c6948393fdc94">soap_wsse_init</a> (struct soap *soap, struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *data, const void *(*arg)(struct soap *, int *alg, const char *keyname, int *keylen))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> (struct soap *soap, const char *tags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set to the string value of the tag's QName by replacing colons with hyphens to produce an xsd:ID value.  <a href="#a9582748dda80d0307e253f1a86c0c454"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a16e38c1160a47ad2cb60d1b7d5dba777">soap_wsse_sign_only</a> (struct soap *soap, const char *tags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Filters only the specified wsu:Id names for signing. Can be used with <a class="el" href="wsseapi_8h.html#a9582748dda80d0307e253f1a86c0c454" title="Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set...">soap_wsse_set_wsu_id()</a> and if so should use the element tag names.  <a href="#a16e38c1160a47ad2cb60d1b7d5dba777"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#aa3ac2afb86a25ec1e1d8e4515133e9ad">soap_wsse_sign</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to sign all wsu:Id attributed elements.  <a href="#aa3ac2afb86a25ec1e1d8e4515133e9ad"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ab653754f1a287ba06bd808cf89548c38">soap_wsse_sign_body</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to sign all wsu:Id attributed elements, including the SOAP Body (by adding a wsu:Id="Body" attribute).  <a href="#ab653754f1a287ba06bd808cf89548c38"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a8a246ebd371d9e92c74ec1e29bf92f3a">soap_wsse_verify_init</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to initiate the verification of the signature and SignedInfo Reference digests.  <a href="#a8a246ebd371d9e92c74ec1e29bf92f3a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a> (struct soap *soap, int alg, const void *key, size_t keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Uses the wsse plugin to initiate the automatic verification of the signature and SignedInfo Reference digests.  <a href="#a7321b451910e1d3887b328f03de92f34"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a07db8f284ab2bb564248999fe02d0169">soap_wsse_verify_done</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Terminates the automatic verification of signatures.  <a href="#a07db8f284ab2bb564248999fe02d0169"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a3fbe81de521579f026dd1ba8e81c59c1">soap_wsse_verify_element</a> (struct soap *soap, const char *URI, const char *tag)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-checks the presence of signed element(s). Does not verify the signature of these elements, which is done with <a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a>.  <a href="#a3fbe81de521579f026dd1ba8e81c59c1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a5ccbce0f1a4a8f103e921a918f932a20">soap_wsse_verify_body</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Post-checks the presence of signed SOAP Body. Does not verify the signature of the Body, which is done with <a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a>.  <a href="#a5ccbce0f1a4a8f103e921a918f932a20"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ac12c951db671e4e29810d0f0ae7f1b63">soap_wsse_encrypt_body</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates the encryption of the SOAP Body. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption.  <a href="#ac12c951db671e4e29810d0f0ae7f1b63"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a3c417c369946561cbf72566349041805">soap_wsse_encrypt_only</a> (struct soap *soap, int alg, const void *key, int keylen, const char *tags)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Initiates the encryption of XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey_encrypt_only for public key encryption.  <a href="#a3c417c369946561cbf72566349041805"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ae783dfb65a01ad8d8e6e7ca1e5b3d805">soap_wsse_encrypt</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Start encryption. This function is supposed to be used internally only. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption.  <a href="#ae783dfb65a01ad8d8e6e7ca1e5b3d805"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a403569990cf3278a361552aecaf51ffc">soap_wsse_decrypt_auto</a> (struct soap *soap, int alg, const void *key, int keylen)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Start automatic decryption when needed using the specified key. This function should be used just once. The algorithm should be SOAP_MEC_ENV_DEC_DES_CBC for public key encryption/decryption and SOAP_MEC_DEC_DES_CBC for symmetric shared secret keys.  <a href="#a403569990cf3278a361552aecaf51ffc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a398ebb03dbadb508185423b3c766aa8c">soap_wsse_encrypt_begin</a> (struct soap *soap, const char *id, int alg, const char *URI, const char *keyname, const unsigned char *key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Emit XML encryption tags and start encryption of the XML element content.  <a href="#a398ebb03dbadb508185423b3c766aa8c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a67d96a5fbfb37797a1223155957111cb">soap_wsse_encrypt_end</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Emit XML encryption end tags and stop encryption of the XML element content.  <a href="#a67d96a5fbfb37797a1223155957111cb"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#adc905be8ab736b213c35fa9114eecfd9">soap_wsse_decrypt_begin</a> (struct soap *soap, const unsigned char *key)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for XML encryption tags and start decryption of the XML element content. If the KeyInfo element is present, the security_token_handler callback will be used to obtain a decryption key based on the key name. Otherwise the current decryption key will be used.  <a href="#adc905be8ab736b213c35fa9114eecfd9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a1862170fdd18b54ab832347308d23019">soap_wsse_decrypt_end</a> (struct soap *soap)</td></tr>
<tr><td class="mdescLeft">&#160;</td><td class="mdescRight">Check for XML encryption ending tags and stop decryption of the XML element content.  <a href="#a1862170fdd18b54ab832347308d23019"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a08c28b1011e1b370838312729cca9c01">soap_wsse_id</a> [14] = SOAP_WSSE_ID</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a38dfc9981f0859b1307c302d8497c08c">wsse_PasswordTextURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a000638936fff26e30a3f256c495c1aa8">wsse_PasswordDigestURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a7d0ae8f2dd1beaabdaa4884ea5dd41e4">wsse_Base64BinaryURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ac07968b1c372e976758745ba7089c367">wsse_X509v3URI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a88d310451ae729bbf0fdd149a9d7511c">wsse_X509v3SubjectKeyIdentifierURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a71140ac907117b2bbf37f14939166a15">ds_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a99bf1005a6700b2e94cc400f799f4b93">ds_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a752690ab049714713ae0d240c0a11350">ds_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#sha512&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a352a6e78890296ade9e25de397f1096c">ds_hmac_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#hmac-sha1&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ab356216a1331e0ba33de2a62d1c8b5fb">ds_hmac_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#hmac-sha256&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a73b877c9a2879fcc6bfd311150beccbd">ds_hmac_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#hmac-sha512&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a1f62c1715e0f49fd54ffc263e45a12eb">ds_dsa_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#dsa-sha1&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad57129724eb01a743b6583afc522a131">ds_rsa_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a739fd4e4c86b17b58877a672bec79bc3">ds_rsa_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a6f17cf69547d2ead56934e89f10f3ba6">ds_rsa_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha512&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a6c5bdcb80c33d0c3d35050091bd2cec5">xenc_rsa15URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a43c42203ea88ef920b653d90307e6731">xenc_rsaesURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a159d359ac83617f624b54d467db4e0b1">xenc_3desURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a289552d8f69933dee3965bb4fc39882b">xenc_aes128URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a04403c472eedb2abd47751086f6a2b37">xenc_aes192URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes192-cbc&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a0ab2e6720de47922659747608b9c40e4">xenc_aes256URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a30367bbed5c37ad3d556607aee6e30dd">xenc_aes512URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes512-cbc&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a4fdac00892919c46ed53fa05b9cc0bdf">xenc_elementURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#Element&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#abc58fc5b358c1f06737a623788dbfa0e">xenc_contentURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#Content&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#ad7aea4af6b24389f66019e8984d4b05c">ds_URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a4089697df0f14ecf44cf0fb6098f4f78">c14n_URI</a> = &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#adb66cffe8d95c5d511987189173a993c">wsu_URI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structsoap__wsse__session.html">soap_wsse_session</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a777b5d06409128e7bcb97703b4f40f06">soap_wsse_session</a> = NULL</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">static MUTEX_TYPE&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="wsseapi_8c.html#a627ba14d70ad7f79d61e2e93485be6ce">soap_wsse_session_lock</a> = MUTEX_INITIALIZER</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a12d6f49d99323ae66d2a6ee154f90469"></a><!-- doxytag: member="wsseapi.c::SOAP_WSSE_CLKSKEW" ref="a12d6f49d99323ae66d2a6ee154f90469" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_CLKSKEW&#160;&#160;&#160;(300)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Clock skew between machines (in sec) to fit message expiration in window </p>

</div>
</div>
<a class="anchor" id="a5c6f8145831c10a4dbd0465a923908c6"></a><!-- doxytag: member="wsseapi.c::SOAP_WSSE_MAX_REF" ref="a5c6f8145831c10a4dbd0465a923908c6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_MAX_REF&#160;&#160;&#160;(100)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Maximum number of SignedInfo References </p>

</div>
</div>
<a class="anchor" id="a65c55be8ba01ac63f64fddbe0e82b75b"></a><!-- doxytag: member="wsseapi.c::SOAP_WSSE_NONCELEN" ref="a65c55be8ba01ac63f64fddbe0e82b75b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_NONCELEN&#160;&#160;&#160;(20)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Size of the random nonce </p>

</div>
</div>
<a class="anchor" id="a5de15cf324b79588e67e4ccbba2119ae"></a><!-- doxytag: member="wsseapi.c::SOAP_WSSE_NONCETIME" ref="a5de15cf324b79588e67e4ccbba2119ae" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SOAP_WSSE_NONCETIME&#160;&#160;&#160;(SOAP_WSSE_CLKSKEW + 240)</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Digest authentication accepts messages that are not older than creation time + SOAP_WSSE_NONCETIME </p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="ae341110563279cc6f5cc57c22eaa7a8b"></a><!-- doxytag: member="wsseapi.c::calc_digest" ref="ae341110563279cc6f5cc57c22eaa7a8b" args="(struct soap *soap, const char *created, const char *nonce, int noncelen, const char *password, char hash[SOAP_SMD_SHA1_SIZE])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void calc_digest </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>created</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>nonce</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>noncelen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>hash</em>[SOAP_SMD_SHA1_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates digest value SHA1(created, nonce, password) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">created</td><td>string (XSD dateTime format) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">noncelen</td><td>length of nonce value </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">hash</td><td>SHA1 digest </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a1c4fe3f38985fd0c526a03fdbafc2ad1"></a><!-- doxytag: member="wsseapi.c::calc_nonce" ref="a1c4fe3f38985fd0c526a03fdbafc2ad1" args="(struct soap *soap, char nonce[SOAP_WSSE_NONCELEN])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void calc_nonce </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>nonce</em>[SOAP_WSSE_NONCELEN]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculates randomized nonce (also uses time() in case a poorly seeded PRNG is used) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nonce</td><td>value </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="af15bedb61bffb589683354bc37d20c3a"></a><!-- doxytag: member="wsseapi.c::soap_wsse" ref="af15bedb61bffb589683354bc37d20c3a" args="(struct soap *soap, struct soap_plugin *p, void *arg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_plugin *&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Plugin registry function, used with soap_register_plugin. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>plugin created in registry </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">arg</td><td>passed from soap_register_plugin_arg is an optional security token handler callback </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a272ece3d02d7fbb5309cda9d1b252822"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_BinarySecurityToken" ref="a272ece3d02d7fbb5309cda9d1b252822" args="(struct soap *soap, const char *id, const char *valueType, const unsigned char *data, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds BinarySecurityToken element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>points to binary token data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>is length of binary token </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ad88d8317bcbbcda4cdc8d1bcfb2e0f18"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_BinarySecurityTokenPEM" ref="ad88d8317bcbbcda4cdc8d1bcfb2e0f18" args="(struct soap *soap, const char *id, const char *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityTokenPEM </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds BinarySecurityToken element from a PEM file. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_FAULT with wsse__InvalidSecurity fault when file cannot be read or does not contain a valid certificate</dd></dl>
<p>This function uses PEM_read_X509 from the the OpenSSL library to read a certificate from a PEM formatted file. </p>

</div>
</div>
<a class="anchor" id="a53075fb3cec4ec4e70fb11850fecb401"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_BinarySecurityTokenX509" ref="a53075fb3cec4ec4e70fb11850fecb401" args="(struct soap *soap, const char *id, X509 *cert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_BinarySecurityTokenX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds BinarySecurityToken element with X509 certificate. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>points to the X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_EOM</dd></dl>
<p>This function uses i2d_X509 from the the OpenSSL library to convert an X509 object to binary DER format. </p>

</div>
</div>
<a class="anchor" id="acbd56e9f4e7da00b1db51bca3e4f226b"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_DataReferenceURI" ref="acbd56e9f4e7da00b1db51bca3e4f226b" args="(struct soap *soap, const char *URI)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_DataReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a DataReference URI to the WS-Security header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>value of the URI ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a0569043138de574a8f61f45b608971ad"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_EncryptedData_KeyInfo_KeyName" ref="a0569043138de574a8f61f45b608971ad" args="(struct soap *soap, const char *keyname)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedData_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyname</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds EncryptedData/ds:KeyInfo/Keyname elements. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyname</td><td>name of the key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code</dd></dl>
<p>This function adds the name of the key to each EncryptedData element to identify the shared secret key used for encryption. </p>

</div>
</div>
<a class="anchor" id="a1ba85a8b14587cff0865ebc3e5e9e340"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_EncryptedKey" ref="a1ba85a8b14587cff0865ebc3e5e9e340" args="(struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subjectkeyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>serial</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds EncryptedKey header element and initiates the encryption of the SOAP Body. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm to use, SOAP_MEC_ENV_ENC_DES_CBC or SOAP_MEC_ENV_ENC_AEAS256_CBC </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>a unique identifier for the key, required for interoperability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>the X509 certificate with public key or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subjectkeyid</td><td>string identification of the subject which when set to non-NULL is used instead of embedding the public key in the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">issuer</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serial</td><td>string to include SecurityTokenReference/X509Data </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code</dd></dl>
<p>This function adds the encrypted key or subject key ID to the WS-Security header and initiates encryption of the SOAP Body. An X509 certificate may be provided, or the subjectkeyid, or the issuer and serial number. The certificate is embedded in the WS-Security EncryptedKey header. If the subjectkeyid string is non-NULL the subject key ID is used in the EncryptedKey header instead of the X509 certificate content. </p>

</div>
</div>
<a class="anchor" id="aeec61121d56b2cf85e48997376c0b50a"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_EncryptedKey_DataReferenceURI" ref="aeec61121d56b2cf85e48997376c0b50a" args="(struct soap *soap, const char *URI)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey_DataReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds a DataReference URI to the EncryptedKey header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>value of the URI ID </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="adef816d148bd8b1ce1c5a3d023712779"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_EncryptedKey_encrypt_only" ref="adef816d148bd8b1ce1c5a3d023712779" args="(struct soap *soap, int alg, const char *URI, X509 *cert, const char *subjectkeyid, const char *issuer, const char *serial, const char *tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_EncryptedKey_encrypt_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>subjectkeyid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>issuer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>serial</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds EncryptedKey header element and initiates encryption of the given XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm to use, SOAP_MEC_ENV_ENC_DES_CBC or SOAP_MEC_ENV_ENC_AEAS256_CBC </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>a unique identifier for the key, required for interoperability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>the X509 certificate with public key or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">subjectkeyid</td><td>string identification of the subject which when set to non-NULL is used instead of embedding the public key in the message </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">issuer</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serial</td><td>string to include SecurityTokenReference/X509Data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>space-separated string of element tag names to encrypt </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structxenc_____encrypted_key_type.html" title="&quot;http://www.w3.org/2001/04/xmlenc#&quot;:EncryptedKeyType is a complexType with complexContent extension o...">xenc__EncryptedKeyType</a> object</dd></dl>
<p>This function adds the encrypted key or subject key ID to the WS-Security header and initiates encryption of the SOAP Body. An X509 certificate may be provided, or the subjectkeyid, or the issuer and serial number. The certificate is embedded in the WS-Security EncryptedKey header. If the subjectkeyid string is non-NULL the subject key ID is used in the EncryptedKey header instead of the X509 certificate content. Only the XML elements given in the 'tags' string as wsu:Id attributed elements are encrypted.</p>
<p>WARNING: Use <a class="el" href="wsseapi_8c.html#adef816d148bd8b1ce1c5a3d023712779">soap_wsse_add_EncryptedKey_encrypt_only</a> only in combination with <a class="el" href="wsseapi_8c.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> with the tag names of the elements to be encrypted. OTHERWISE THE GIVEN XML ELEMENTS ARE NOT ENCRYPTED AND WILL BE SENT IN THE CLEAR.</p>
<p>WARNING: The elements identified with <a class="el" href="wsseapi_8c.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> to encrypt MUST occur EXACTLY ONCE in the SOAP Body.</p>
<p>WARNING: Encryption/decryption of elements with simple content (CDATA content) IS NOT SUPPORTED. This means that elements you want to encrypt with this function must have complex content. That is, only encrypt elements with sub elements or encrypt the entire SOAP Body. </p>

</div>
</div>
<a class="anchor" id="ac80606801677bc109bcef606655f6e23"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo" ref="ac80606801677bc109bcef606655f6e23" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a>* soap_wsse_add_KeyInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyInfo element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>ds__KeyInfo object </dd></dl>

</div>
</div>
<a class="anchor" id="a25240140007f1776479e81dd43457f40"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo_KeyName" ref="a25240140007f1776479e81dd43457f40" args="(struct soap *soap, const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyName element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">name</td><td>string of the KeyName </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>Note: the recommended method to add Key information is to utilize KeyIdentifier instead of KeyName. A KeyName is useful mainly for internal use. </p>

</div>
</div>
<a class="anchor" id="a8fcf5947eb011d73b6a6b1308123a536"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo_SecurityTokenReferenceEmbedded" ref="a8fcf5947eb011d73b6a6b1308123a536" args="(struct soap *soap, const char *id, const char *valueType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceEmbedded </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyInfo element with Embedded SecurityTokenReference. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>Note: this function does not add embedded tokens automatically. See code for comments. </p>

</div>
</div>
<a class="anchor" id="a83ad7822556d691020209fa12d1c79a7"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo_SecurityTokenReferenceKeyIdentifier" ref="a83ad7822556d691020209fa12d1c79a7" args="(struct soap *soap, const char *id, const char *valueType, unsigned char *data, int size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference/KeyIdentifier binary data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>binary data </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">size</td><td>of binary data </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="aa1557c59801a0c3e4a77c1cb56cc2d9e"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo_SecurityTokenReferenceURI" ref="aa1557c59801a0c3e4a77c1cb56cc2d9e" args="(struct soap *soap, const char *URI, const char *valueType)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>valueType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference URI. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string referencing a security token </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">valueType</td><td>string or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a72df80abd1d36cea516feda3a84672cf"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_KeyInfo_SecurityTokenReferenceX509" ref="a72df80abd1d36cea516feda3a84672cf" args="(struct soap *soap, const char *URI)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_KeyInfo_SecurityTokenReferenceX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds KeyInfo element with SecurityTokenReference URI to an X509 cert. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string referencing an X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a6f167767a1a7763be6dc2b8eff75e419"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_Security" ref="a6f167767a1a7763be6dc2b8eff75e419" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a>* soap_wsse_add_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds Security header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="aba5822fee3cafde84e4bcae41a37fc69"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_Security_actor" ref="aba5822fee3cafde84e4bcae41a37fc69" args="(struct soap *soap, const char *actor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a>* soap_wsse_add_Security_actor </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>actor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds Security header element with actor or role attribute. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">actor</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a4941ccab15e473e979ff4b3a926c04bb"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_SecurityContextToken" ref="a4941ccab15e473e979ff4b3a926c04bb" args="(struct soap *soap, const char *id, const char *identifier)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SecurityContextToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>identifier</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds wsc:SecurityContextToken/Identifier and SecurityTokenReference to it. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">identifier</td><td>wsc:Identifier value </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a07b4f0c2995df0a695a6f06e2519151f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_Signature" ref="a07b4f0c2995df0a695a6f06e2519151f" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a>* soap_wsse_add_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds Signature header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structds_____signature_type.html" title="Imported complexType &quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignatureType from typemap WS/WS-typemap...">ds__SignatureType</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="a7399c40e0019bc1ae797fccf92f81fc7"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_SignatureValue" ref="a7399c40e0019bc1ae797fccf92f81fc7" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignatureValue </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds SignedInfo/SignatureMethod element, signs the SignedInfo element, and adds the resulting SignatureValue element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is SOAP_SMD_HMAC_SHA1, SOAP_SMD_SIGN_DSA_SHA1, or SOAP_SMD_SIGN_RSA_SHA1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>to use to sign (HMAC or EVP_PKEY) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>length of HMAC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK, SOAP_EOM, or fault</dd></dl>
<p>To sign the SignedInfo element with this function, populate SignedInfo with Reference elements first using soap_wsse_add_SignedInfo_Reference. The SignedInfo element must not be modified after signing.</p>
<p>The SOAP_XML_INDENT and SOAP_XML_CANONICAL flags are used to serialize the SignedInfo to compute the signature. </p>

</div>
</div>
<a class="anchor" id="ab4a10d08044dd66da337f684385ed2cf"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_SignedInfo" ref="ab4a10d08044dd66da337f684385ed2cf" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a>* soap_wsse_add_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds SignedInfo element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structds_____signed_info_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignedInfoType is a complexType.">ds__SignedInfoType</a> object </dd></dl>

</div>
</div>
<a class="anchor" id="aa5ea0bcecf8f77929b70b4603d5d6a0e"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_SignedInfo_Reference" ref="aa5ea0bcecf8f77929b70b4603d5d6a0e" args="(struct soap *soap, const char *URI, const char *transform, const char *inclusiveNamespaces, int alg, const char *HA)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignedInfo_Reference </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>transform</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>inclusiveNamespaces</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>HA</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds SignedInfo element with Reference URI, transform algorithm used, and digest value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>reference </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">transform</td><td>string should be c14n_URI for exc-c14n or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inclusiveNamespaces</td><td>used by the exc-c14n transform or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the digest algorithm used </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">HA</td><td>is the digest in binary form </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_EOM when references exceed SOAP_WSSE_MAX_REF</dd></dl>
<p>This function can be called to add more references to the wsse:SignedInfo element. A maximum number of SOAP_WSSE_MAX_REF references can be added. The digest method is always SHA1. Note: XPath transforms cannot be specified in this release. </p>

</div>
</div>
<a class="anchor" id="a398f98d62dfba91d04cff19230fb6722"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_SignedInfo_SignatureMethod" ref="a398f98d62dfba91d04cff19230fb6722" args="(struct soap *soap, const char *method, int canonical)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_SignedInfo_SignatureMethod </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>canonical</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds SignedInfo element with SignatureMethod. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">method</td><td>is the URI of the signature algorithm (e.g. ds_rsa_sha1) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">canonical</td><td>flag indicating that SignedInfo is signed in exc-c14n form </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>Note: the c14n:InclusiveNamespaces/PrefixList is set to "SOAP-ENV wsse". </p>

</div>
</div>
<a class="anchor" id="a71fe27aee76db1d0a635afe106d8b109"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_Timestamp" ref="a71fe27aee76db1d0a635afe106d8b109" args="(struct soap *soap, const char *id, time_t lifetime)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">time_t&#160;</td>
          <td class="paramname"><em>lifetime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds Timestamp element with optional expiration date+time (lifetime). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">lifetime</td><td>expressed in time_t units, or 0 for no expiration </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ac9fe59008bdf12d7a007ac48e6ebb613"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_UsernameTokenDigest" ref="ac9fe59008bdf12d7a007ac48e6ebb613" args="(struct soap *soap, const char *id, const char *username, const char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_UsernameTokenDigest </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds UsernameToken element for digest authentication. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>Computes SHA1 digest of the time stamp, a nonce, and the password. The digest provides the authentication credentials. Passwords are NOT sent in the clear. Note: this release supports the use of at most one UsernameToken in the header. </p>

</div>
</div>
<a class="anchor" id="a37f32e51bceabf2e2823516a1737548f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_add_UsernameTokenText" ref="a37f32e51bceabf2e2823516a1737548f" args="(struct soap *soap, const char *id, const char *username, const char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_add_UsernameTokenText </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>username</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Adds UsernameToken element with optional clear-text password. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for signature referencing or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">username</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string or NULL to omit the password </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>Passwords are sent in the clear, so transport-level encryption is required. Note: this release supports the use of at most one UsernameToken in the header. </p>

</div>
</div>
<a class="anchor" id="ab0d5552252e672a0ea24af9b6595bd2c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_BinarySecurityToken" ref="ab0d5552252e672a0ea24af9b6595bd2c" args="(struct soap *soap, const char *id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsse_____binary_security_token.html">_wsse__BinarySecurityToken</a>* soap_wsse_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns BinarySecurityToken element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsse_____binary_security_token.html" title="This element defines the wsse:BinarySecurityToken element per Section 4.2. Imported element _wsse__Bi...">_wsse__BinarySecurityToken</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a491ec857faca76dce6ff59218e58626c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_copy" ref="a491ec857faca76dce6ff59218e58626c" args="(struct soap *soap, struct soap_plugin *dst, struct soap_plugin *src)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_copy </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_plugin *&#160;</td>
          <td class="paramname"><em>dst</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_plugin *&#160;</td>
          <td class="paramname"><em>src</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Copies plugin data to localize plugin data for threads. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">dst</td><td>target plugin </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">src</td><td>source plugin </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a403569990cf3278a361552aecaf51ffc"></a><!-- doxytag: member="wsseapi.c::soap_wsse_decrypt_auto" ref="a403569990cf3278a361552aecaf51ffc" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_auto </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start automatic decryption when needed using the specified key. This function should be used just once. The algorithm should be SOAP_MEC_ENV_DEC_DES_CBC for public key encryption/decryption and SOAP_MEC_DEC_DES_CBC for symmetric shared secret keys. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the decryption algorithm, </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a persistent decryption key for the algorithm, a private RSA key or a shared symmetric secret key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>use 0 for public-key encryption/decryption or the shared secret decryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code</dd></dl>
<p>This function can be called once before multiple messages are received with WS-Security encrypted content, where only one key is used for encryption (public key or shared secret key). The default decryption key is set. If multiple decryption keys should be used, do NOT use this function but set the security_token_handler callback of the wsse plugin. See <a class="el" href="wsse.html#wsse_9_2">Decrypting Message Parts</a>. Use a NULL key to remove the default decryption key. </p>

</div>
</div>
<a class="anchor" id="adc905be8ab736b213c35fa9114eecfd9"></a><!-- doxytag: member="wsseapi.c::soap_wsse_decrypt_begin" ref="adc905be8ab736b213c35fa9114eecfd9" args="(struct soap *soap, const unsigned char *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_begin </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check for XML encryption tags and start decryption of the XML element content. If the KeyInfo element is present, the security_token_handler callback will be used to obtain a decryption key based on the key name. Otherwise the current decryption key will be used. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>optional triple DES key for decryption (to override the current key) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a1862170fdd18b54ab832347308d23019"></a><!-- doxytag: member="wsseapi.c::soap_wsse_decrypt_end" ref="a1862170fdd18b54ab832347308d23019" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_decrypt_end </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check for XML encryption ending tags and stop decryption of the XML element content. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a67455a9af65734dc71fa3e3bf66a6738"></a><!-- doxytag: member="wsseapi.c::soap_wsse_delete" ref="a67455a9af65734dc71fa3e3bf66a6738" args="(struct soap *soap, struct soap_plugin *p)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void soap_wsse_delete </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_plugin *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes plugin data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">p</td><td>plugin </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="ad276cfcbd007515a6dce80c646e23ef5"></a><!-- doxytag: member="wsseapi.c::soap_wsse_delete_EncryptedKey" ref="ad276cfcbd007515a6dce80c646e23ef5" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes EncryptedKey header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ac06c7021592b2aaca50f73e0de9dec7c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_delete_Security" ref="ac06c7021592b2aaca50f73e0de9dec7c" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes Security header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ad817f20012b39724f7351909b0b79df2"></a><!-- doxytag: member="wsseapi.c::soap_wsse_delete_Signature" ref="ad817f20012b39724f7351909b0b79df2" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void soap_wsse_delete_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Deletes Signature header element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a903b3f58fd8b9699751c703793f06435"></a><!-- doxytag: member="wsseapi.c::soap_wsse_element_begin_in" ref="a903b3f58fd8b9699751c703793f06435" args="(struct soap *soap, const char *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_element_begin_in </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This callback is invoked as soon as a starting tag of an element is received by the XML parser. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>name of the element parsed </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ad7924c5bd34781df563ed2339eab59f3"></a><!-- doxytag: member="wsseapi.c::soap_wsse_element_begin_out" ref="ad7924c5bd34781df563ed2339eab59f3" args="(struct soap *soap, const char *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_element_begin_out </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This callback is invoked as soon as a starting tag of an element is to be sent by the XML generator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>name of the element </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ae095227834179806af2ea7dc90bd961e"></a><!-- doxytag: member="wsseapi.c::soap_wsse_element_end_in" ref="ae095227834179806af2ea7dc90bd961e" args="(struct soap *soap, const char *tag1, const char *tag2)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_element_end_in </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This callback is invoked as soon as an ending tag of an element is received by the XML parser. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag1</td><td>name of the element parsed </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag2</td><td>name of the element that was expected by the parser's state, or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a04ac9993d22e7b868135f9b7ebcca8e0"></a><!-- doxytag: member="wsseapi.c::soap_wsse_element_end_out" ref="a04ac9993d22e7b868135f9b7ebcca8e0" args="(struct soap *soap, const char *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_element_end_out </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This callback is invoked as soon as an ending tag of an element is to be sent by the XML generator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tag</td><td>name of the element </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ae783dfb65a01ad8d8e6e7ca1e5b3d805"></a><!-- doxytag: member="wsseapi.c::soap_wsse_encrypt" ref="ae783dfb65a01ad8d8e6e7ca1e5b3d805" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start encryption. This function is supposed to be used internally only. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a398ebb03dbadb508185423b3c766aa8c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_encrypt_begin" ref="a398ebb03dbadb508185423b3c766aa8c" args="(struct soap *soap, const char *id, int alg, const char *URI, const char *keyname, const unsigned char *key)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_begin </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>keyname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>key</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Emit XML encryption tags and start encryption of the XML element content. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string for the EncryptedData element Id attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>algorithm used, or SOAP_MEC_NONE to ignore </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">URI</td><td>string for the encrypted element wsu:Id attribute </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keyname</td><td>optional subject key name </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>optional DES/AES key for encryption (to override the current key) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="ac12c951db671e4e29810d0f0ae7f1b63"></a><!-- doxytag: member="wsseapi.c::soap_wsse_encrypt_body" ref="ac12c951db671e4e29810d0f0ae7f1b63" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiates the encryption of the SOAP Body. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey for public key encryption. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code</dd></dl>
<p>This function initiates the encryption of the SOAP Body using an RSA public key or a symmetric shared secret key. No WS-Security EncryptedKey header will be set. Use soap_wsse_add_EncryptedKey instead for public key encryption. </p>

</div>
</div>
<a class="anchor" id="a67d96a5fbfb37797a1223155957111cb"></a><!-- doxytag: member="wsseapi.c::soap_wsse_encrypt_end" ref="a67d96a5fbfb37797a1223155957111cb" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_end </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Emit XML encryption end tags and stop encryption of the XML element content. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a3c417c369946561cbf72566349041805"></a><!-- doxytag: member="wsseapi.c::soap_wsse_encrypt_only" ref="a3c417c369946561cbf72566349041805" args="(struct soap *soap, int alg, const void *key, int keylen, const char *tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_encrypt_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiates the encryption of XML elements specified in the tags string. Should be used in combination with soap_wsse_set_wsu_id to set wsu:Id for given XML element tags. The algorithm should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC for symmetric encryption. Use soap_wsse_add_EncryptedKey_encrypt_only for public key encryption. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>the encryption algorithm, should be SOAP_MEC_ENC_DES_CBC or one of SOAP_MEC_ENC_AESxxx_CBC </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>a certificate with public key for encryption, a DES CBC 160-bit key or AES key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>the symmetric encryption key length, 20 bytes for a DES CBC 160-bit key </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code</dd></dl>
<p>This function initiates the encryption using an RSA public key or a symmetric shared secret key. No WS-Security EncryptedKey header will be set. Use soap_wsse_add_EncryptedKey instead for public key encryption.</p>
<p>WARNING: Use <a class="el" href="wsseapi_8c.html#adef816d148bd8b1ce1c5a3d023712779">soap_wsse_add_EncryptedKey_encrypt_only</a> only in combination with <a class="el" href="wsseapi_8c.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> with the tag names of the elements to be encrypted. OTHERWISE THE GIVEN XML ELEMENTS ARE NOT ENCRYPTED AND WILL BE SENT IN THE CLEAR.</p>
<p>WARNING: The elements identified with <a class="el" href="wsseapi_8c.html#a9582748dda80d0307e253f1a86c0c454">soap_wsse_set_wsu_id</a> to encrypt MUST occur EXACTLY ONCE in the SOAP Body.</p>
<p>WARNING: Encryption/decryption of elements with simple content (CDATA content) IS NOT SUPPORTED. This means that elements you want to encrypt with this function must have complex content. That is, only encrypt elements with sub elements or encrypt the entire SOAP Body. </p>

</div>
</div>
<a class="anchor" id="a82fe0ee01741a65f835fa0ffaad0a157"></a><!-- doxytag: member="wsseapi.c::soap_wsse_EncryptedKey" ref="a82fe0ee01741a65f835fa0ffaad0a157" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structxenc_____encrypted_key_type.html">xenc__EncryptedKeyType</a>* soap_wsse_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns EncryptedKey header element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structxenc_____encrypted_key_type.html" title="&quot;http://www.w3.org/2001/04/xmlenc#&quot;:EncryptedKeyType is a complexType with complexContent extension o...">xenc__EncryptedKeyType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a2d9787c17c1738314cfb3c2fc4aca3ff"></a><!-- doxytag: member="wsseapi.c::soap_wsse_fault" ref="a2d9787c17c1738314cfb3c2fc4aca3ff" args="(struct soap *soap, wsse__FaultcodeEnum fault, const char *detail)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="wsse_8h.html#aaade5f4816d66546a0817dade206f50f">wsse__FaultcodeEnum</a>&#160;</td>
          <td class="paramname"><em>fault</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>detail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets SOAP Fault (sub)code for server response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fault</td><td>is one of wsse:FaultcodeEnum </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">detail</td><td>string with optional text message </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a7496da1dd76aa06e6657365b5c7dd76d"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_BinarySecurityToken" ref="a7496da1dd76aa06e6657365b5c7dd76d" args="(struct soap *soap, const char *id, char **valueType, unsigned char **data, int *size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_get_BinarySecurityToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>valueType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char **&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get wsse:BinarySecurityToken element token data in binary form. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">valueType</td><td>string </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">data</td><td>points to binary token data </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>is length of binary token </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_FAULT with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="af88b4ff21d348c6b256b72b600514e14"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_BinarySecurityTokenX509" ref="af88b4ff21d348c6b256b72b600514e14" args="(struct soap *soap, const char *id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">X509* soap_wsse_get_BinarySecurityTokenX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get X509 wsse:BinarySecurityToken certificate and verify its content. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of token to get or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>X509 certificate (dynamically allocated) or NULL with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="aeb7b82c21d0022bd1ac08c843cefe75f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_KeyName" ref="aeb7b82c21d0022bd1ac08c843cefe75f" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_KeyInfo_KeyName </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns KeyName element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="af7c3fc130e6925df8af8d004c925c008"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifier" ref="af7c3fc130e6925df8af8d004c925c008" args="(struct soap *soap, int *size)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned char* soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifier </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns KeyInfo/SecurityTokenReference/KeyIdentifier binary data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">size</td><td>is set to the size of the decoded data </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>data or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="aa828d0c93226ca87c382a831fcdc703c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifierValueType" ref="aa828d0c93226ca87c382a831fcdc703c" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_KeyInfo_SecurityTokenReferenceKeyIdentifierValueType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns KeyInfo/SecurityTokenReference/KeyIdentifier/ValueType if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="aaf44a9fdec53a3a7ec2ff1a9dae6c51c"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceURI" ref="aaf44a9fdec53a3a7ec2ff1a9dae6c51c" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_KeyInfo_SecurityTokenReferenceURI </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a SecurityTokenReference URI if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="ad7f620007d3395a0e361495f2034492a"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceValueType" ref="ad7f620007d3395a0e361495f2034492a" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_KeyInfo_SecurityTokenReferenceValueType </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a SecurityTokenReference ValueType if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="afeea66260af15add6e581e8dfc18361a"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceX509" ref="afeea66260af15add6e581e8dfc18361a" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">X509* soap_wsse_get_KeyInfo_SecurityTokenReferenceX509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a X509 certificate if present as a BinarySecurity token. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>X509 object or NULL with wsse:SecurityTokenUnavailable fault </dd></dl>

</div>
</div>
<a class="anchor" id="a458ef16bc2a6a93fab21bdfcbfc34d5d"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_KeyInfo_SecurityTokenReferenceX509Data" ref="a458ef16bc2a6a93fab21bdfcbfc34d5d" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____x509_issuer_serial_type.html">ds__X509IssuerSerialType</a>* soap_wsse_get_KeyInfo_SecurityTokenReferenceX509Data </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType.">ds__X509IssuerSerialType</a> with non-NULL X509IssuerName and non-NULL X509SerialNumber of a X509Data element when present and set. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to <a class="el" href="structds_____x509_issuer_serial_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:X509IssuerSerialType is a complexType.">ds__X509IssuerSerialType</a> struct or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a12a8109d64be5b5da7afd7679ed2e681"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_SecurityContextToken" ref="a12a8109d64be5b5da7afd7679ed2e681" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_SecurityContextToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns wsc:SecurityContextToken/Identifier string value or NULL. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>wsc:SecurityContextToken/Identifier string value value or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="afd4c4268cc8f9d667cc44586fb635b5d"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_SignedInfo_SignatureMethod" ref="afd4c4268cc8f9d667cc44586fb635b5d" args="(struct soap *soap, int *alg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_get_SignedInfo_SignatureMethod </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>alg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get SignatureMethod algorithm. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">alg</td><td>is a signature algorithm, such as SOAP_SMD_HMAC_SHA1, SOAP_SMD_VRFY_DSA_SHA1, or SOAP_SMD_VRFY_RSA_SHA1 </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_FAULT with wsse:UnsupportedAlgorithm or wsse:FailedCheck fault </dd></dl>

</div>
</div>
<a class="anchor" id="a936a081cece9995f265b885e113ff5db"></a><!-- doxytag: member="wsseapi.c::soap_wsse_get_Username" ref="a936a081cece9995f265b885e113ff5db" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* soap_wsse_get_Username </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns UsernameToken/username string or wsse:FailedAuthentication fault. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>UsernameToken/username string or NULL with wsse:FailedAuthentication fault error set </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="wsseapi_8c.html#aeb0afd01a5036e4f1314a3cfe8575bd5" title="Verifies the supplied password or sets wsse:FailedAuthentication fault.">soap_wsse_verify_Password</a></dd></dl>
<p>The returned username should be used to lookup the user's password in a dictionary or database for server-side authentication with soap_wsse_verify_Password. </p>

</div>
</div>
<a class="anchor" id="a278a5511160aade2c206b0225781ff04"></a><!-- doxytag: member="wsseapi.c::soap_wsse_header" ref="a278a5511160aade2c206b0225781ff04" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_header </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>This callback is invoked as soon as the SOAP Header is received, we need to obtain the encrypted key when the message is encrypted to start decryption. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a3dafa97e60020d63fdd4be32aefa4119"></a><!-- doxytag: member="wsseapi.c::soap_wsse_ids" ref="a3dafa97e60020d63fdd4be32aefa4119" args="(struct soap *soap, const char *tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static char * soap_wsse_ids </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>converts tag name(s) to id name(s) </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated (un)qualified tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string of ids </dd></dl>

</div>
</div>
<a class="anchor" id="aae73086424d1c8386d3c6948393fdc94"></a><!-- doxytag: member="wsseapi.c::soap_wsse_init" ref="aae73086424d1c8386d3c6948393fdc94" args="(struct soap *soap, struct soap_wsse_data *data, const void *(*arg)(struct soap *, int *alg, const char *keyname, int *keylen))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_init </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *(*)(struct soap *, int *alg, const char *keyname, int *keylen)&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ae9f8c9147cb058c0316f7f8c935a1b92"></a><!-- doxytag: member="wsseapi.c::soap_wsse_init" ref="ae9f8c9147cb058c0316f7f8c935a1b92" args="(struct soap *soap, struct soap_wsse_data *data, const void *(*arg)(struct soap *, int *, const char *, int *))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_init </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *(*)(struct soap *, int *, const char *, int *)&#160;</td>
          <td class="paramname"><em>arg</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initializes plugin data. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">data</td><td>plugin data </td></tr>
    <tr><td class="paramdir"></td><td class="paramname">arg</td><td>security token handler callback </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a3978578b5dd8dc7065e9946982fe7d57"></a><!-- doxytag: member="wsseapi.c::soap_wsse_KeyInfo" ref="a3978578b5dd8dc7065e9946982fe7d57" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____key_info_type.html">ds__KeyInfoType</a>* soap_wsse_KeyInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns KeyInfo element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>ds__KeyInfo object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a9f2b5e6c2242b3516e624d1b2b25ee1e"></a><!-- doxytag: member="wsseapi.c::soap_wsse_preparecleanup" ref="a9f2b5e6c2242b3516e624d1b2b25ee1e" args="(struct soap *soap, struct soap_wsse_data *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void soap_wsse_preparecleanup </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoap__wsse__data.html">soap_wsse_data</a> *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Restores engine state. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">data</td><td>plugin data </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ae3558fa3952e01ec72fbd5f9bf4b1b37"></a><!-- doxytag: member="wsseapi.c::soap_wsse_preparefinalrecv" ref="ae3558fa3952e01ec72fbd5f9bf4b1b37" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_preparefinalrecv </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verify signature and SignedInfo digests initiated with soap_wsse_verify_auto. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault </dd></dl>
<dl class="see"><dt><b>See also:</b></dt><dd><a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34" title="Uses the wsse plugin to initiate the automatic verification of the signature and SignedInfo Reference...">soap_wsse_verify_auto</a></dd></dl>
<p>This callback is invoked just after a message was received. </p>

</div>
</div>
<a class="anchor" id="a0a65a4a97fc2ed131ef7a24da07ba08f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_preparefinalsend" ref="a0a65a4a97fc2ed131ef7a24da07ba08f" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_preparefinalsend </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Collects the digests of all the wsu:Id elements and populates the SignedInfo. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault</dd></dl>
<p>This callback is invoked just before the message is sent. </p>

</div>
</div>
<a class="anchor" id="aa3df0ea602c9868f5e1c7d636aeeddf9"></a><!-- doxytag: member="wsseapi.c::soap_wsse_preparesend" ref="aa3df0ea602c9868f5e1c7d636aeeddf9" args="(struct soap *soap, const char *buf, size_t len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_preparesend </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Takes a piece of the XML message (tokenized) to compute digest. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">buf</td><td>string (XML "tokenized") to be sent </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">len</td><td>buf length </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault</dd></dl>
<p>This callback is invoked to analyze a message (usually during the HTTP content length phase). Note: nested elements with wsu:Id attributes cannot be individually signed. </p>

</div>
</div>
<a class="anchor" id="a7590c46443ff1c74365091d2d7806829"></a><!-- doxytag: member="wsseapi.c::soap_wsse_receiver_fault" ref="a7590c46443ff1c74365091d2d7806829" args="(struct soap *soap, const char *faultstring, const char *faultdetail)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_receiver_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets receiver SOAP Fault for server fault response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a5cec82648247163c63a28d624b2b9fe8"></a><!-- doxytag: member="wsseapi.c::soap_wsse_receiver_fault_subcode" ref="a5cec82648247163c63a28d624b2b9fe8" args="(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_receiver_fault_subcode </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultsubcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets receiver SOAP Fault (sub)code for server fault response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultsubcode</td><td>sub code string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a5d9f35b53cbf1b94d7bc3fdfa1728485"></a><!-- doxytag: member="wsseapi.c::soap_wsse_Security" ref="a5d9f35b53cbf1b94d7bc3fdfa1728485" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsse_____security.html">_wsse__Security</a>* soap_wsse_Security </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns Security header element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsse_____security.html" title="This element defines the wsse:Security SOAP header element per Section 4. Imported element _wsse__Sec...">_wsse__Security</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a0e7d820ea5bf71efb136bb7f0ffbb71f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_sender_fault" ref="a0e7d820ea5bf71efb136bb7f0ffbb71f" args="(struct soap *soap, const char *faultstring, const char *faultdetail)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sender_fault </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets sender SOAP Fault for server fault response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="aac4234bd51599c36aec7bf7888191fb0"></a><!-- doxytag: member="wsseapi.c::soap_wsse_sender_fault_subcode" ref="aac4234bd51599c36aec7bf7888191fb0" args="(struct soap *soap, const char *faultsubcode, const char *faultstring, const char *faultdetail)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sender_fault_subcode </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultsubcode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>faultdetail</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets sender SOAP Fault (sub)code for server fault response. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultsubcode</td><td>sub code string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultstring</td><td>fault string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">faultdetail</td><td>detail string </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a0dd21015cab9811c9da9b08117401ad5"></a><!-- doxytag: member="wsseapi.c::soap_wsse_session_cleanup" ref="a0dd21015cab9811c9da9b08117401ad5" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static void soap_wsse_session_cleanup </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes expired authentication data from the digest authentication session database. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="acb666de6b99187df159aaee8219317bd"></a><!-- doxytag: member="wsseapi.c::soap_wsse_session_verify" ref="acb666de6b99187df159aaee8219317bd" args="(struct soap *soap, const char hash[SOAP_SMD_SHA1_SIZE], const char *created, const char *nonce)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static int soap_wsse_session_verify </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>hash</em>[SOAP_SMD_SHA1_SIZE], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>created</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>nonce</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies and updates the digest, nonce, and creation time against the digest authentication session database to prevent replay attacks. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash</td><td>binary digest value of PasswordDigest </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">created</td><td>string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nonce</td><td>string (base64) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_FAULT </dd></dl>

</div>
</div>
<a class="anchor" id="a9582748dda80d0307e253f1a86c0c454"></a><!-- doxytag: member="wsseapi.c::soap_wsse_set_wsu_id" ref="a9582748dda80d0307e253f1a86c0c454" args="(struct soap *soap, const char *tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_set_wsu_id </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set to the string value of the tag's QName by replacing colons with hyphens to produce an xsd:ID value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified element tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="aa3ac2afb86a25ec1e1d8e4515133e9ad"></a><!-- doxytag: member="wsseapi.c::soap_wsse_sign" ref="aa3ac2afb86a25ec1e1d8e4515133e9ad" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the wsse plugin to sign all wsu:Id attributed elements. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the signature algorithm, such as SOAP_SMD_HMAC_SHA1, SOAP_SMD_SIGN_DSA_SHA1, or SOAP_SMD_SIGN_RSA_SHA1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is the HMAC secret key or DSA/RSA private EVP_PKEY </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is the HMAC key length </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault</dd></dl>
<p>This function does not actually sign the message, but initiates the plugin's signature algorithm to sign the message upon message transfer. </p>

</div>
</div>
<a class="anchor" id="ab653754f1a287ba06bd808cf89548c38"></a><!-- doxytag: member="wsseapi.c::soap_wsse_sign_body" ref="ab653754f1a287ba06bd808cf89548c38" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the wsse plugin to sign all wsu:Id attributed elements, including the SOAP Body (by adding a wsu:Id="Body" attribute). </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is the signature algorithm, such as SOAP_SMD_HMAC_SHA1, SOAP_SMD_SIGN_DSA_SHA1, or SOAP_SMD_SIGN_RSA_SHA1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is the HMAC secret key or DSA/RSA private EVP_PKEY </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is the HMAC key length </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>This function does not actually sign the message, but initiates the plugin's signature algorithm to sign the message upon message transfer. </p>

</div>
</div>
<a class="anchor" id="a16e38c1160a47ad2cb60d1b7d5dba777"></a><!-- doxytag: member="wsseapi.c::soap_wsse_sign_only" ref="a16e38c1160a47ad2cb60d1b7d5dba777" args="(struct soap *soap, const char *tags)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_sign_only </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Filters only the specified wsu:Id names for signing. Can be used with <a class="el" href="wsseapi_8h.html#a9582748dda80d0307e253f1a86c0c454" title="Sets the elements that are to be extended with wsu:Id attributes. The wsu:Id attribute values are set...">soap_wsse_set_wsu_id()</a> and if so should use the element tag names. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tags</td><td>string of space-separated qualified and unqualified tag names </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a4b8fe90c13170958dcee629a519c4451"></a><!-- doxytag: member="wsseapi.c::soap_wsse_Signature" ref="a4b8fe90c13170958dcee629a519c4451" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____signature_type.html">ds__SignatureType</a>* soap_wsse_Signature </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns Signature header element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structds_____signature_type.html" title="Imported complexType &quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignatureType from typemap WS/WS-typemap...">ds__SignatureType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a216e30bdddd04d328398126851d0f87a"></a><!-- doxytag: member="wsseapi.c::soap_wsse_SignedInfo" ref="a216e30bdddd04d328398126851d0f87a" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structds_____signed_info_type.html">ds__SignedInfoType</a>* soap_wsse_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns SignedInfo element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="structds_____signed_info_type.html" title="&quot;http://www.w3.org/2000/09/xmldsig#&quot;:SignedInfoType is a complexType.">ds__SignedInfoType</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a55271d6c4b775d88995a5e4837142b0f"></a><!-- doxytag: member="wsseapi.c::soap_wsse_Timestamp" ref="a55271d6c4b775d88995a5e4837142b0f" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsu_____timestamp.html">_wsu__Timestamp</a>* soap_wsse_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns Timestamp element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsu_____timestamp.html" title="This element allows Timestamps to be applied anywhere element wildcards are present, including as a SOAP header. Imported element _wsu__Timestamp from typemap WS/WS-typemap.dat.">_wsu__Timestamp</a> object or NULL </dd></dl>

</div>
</div>
<a class="anchor" id="a6bde1e5babdeb24b2f88666a837d4c21"></a><!-- doxytag: member="wsseapi.c::soap_wsse_UsernameToken" ref="a6bde1e5babdeb24b2f88666a837d4c21" args="(struct soap *soap, const char *id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct__wsse_____username_token.html">_wsse__UsernameToken</a>* soap_wsse_UsernameToken </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns UsernameToken element if present. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of UsernameToken or NULL </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd><a class="el" href="struct__wsse_____username_token.html" title="This element defines the wsse:UsernameToken element per Section 4.1. Imported element _wsse__Username...">_wsse__UsernameToken</a> object or NULL</dd></dl>
<p>Note: this release supports the use of at most one UsernameToken in the header. </p>

</div>
</div>
<a class="anchor" id="a7321b451910e1d3887b328f03de92f34"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_auto" ref="a7321b451910e1d3887b328f03de92f34" args="(struct soap *soap, int alg, const void *key, size_t keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_auto </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the wsse plugin to initiate the automatic verification of the signature and SignedInfo Reference digests. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>to verify signature if signature has no secret or public key, use SOAP_SMD_NONE to omit </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>is HMAC key or EVP_PKEY or NULL </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>is HMAC key length or 0 </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>This function does not actually verify the message, but initiates the plugin's algorithm to store the message in a DOM to automatically verify the signature and digests. If the message does not contain a key to verify the signature, the alg, key, and keylen parameters are used. It is important that the X509 certificate used to verify the signature, which requires soap-&gt;cafile and/or soap-&gt;capath to be set. </p>

</div>
</div>
<a class="anchor" id="a5ccbce0f1a4a8f103e921a918f932a20"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_body" ref="a5ccbce0f1a4a8f103e921a918f932a20" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_body </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post-checks the presence of signed SOAP Body. Does not verify the signature of the Body, which is done with <a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK (signed) or SOAP_FAULT</dd></dl>
<p>This function does not actually verify the signature of the Body. It checks whether the Body is signed and thus its integrity is preserved. Clients should call this function after invocation. Services should call this function inside a service operation. This function traverses the entire DOM, so performance is determined by the size of a message. </p>

</div>
</div>
<a class="anchor" id="acf1c213ea26a2286f9c0457849bd6290"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_digest" ref="acf1c213ea26a2286f9c0457849bd6290" args="(struct soap *soap, int alg, int canonical, const char *id, unsigned char hash[SOAP_SMD_MAX_SIZE])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_digest </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>canonical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char&#160;</td>
          <td class="paramname"><em>hash</em>[SOAP_SMD_MAX_SIZE]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the digest value of an XML element referenced by id against the hash. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>digest algorithm </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">canonical</td><td>flag indicating that element is signed in exc-c14n form </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">id</td><td>string of the XML element to verify </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">hash</td><td>digest value to verify against </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault </dd></dl>

</div>
</div>
<a class="anchor" id="a07db8f284ab2bb564248999fe02d0169"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_done" ref="a07db8f284ab2bb564248999fe02d0169" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_done </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Terminates the automatic verification of signatures. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK </dd></dl>

</div>
</div>
<a class="anchor" id="a3fbe81de521579f026dd1ba8e81c59c1"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_element" ref="a3fbe81de521579f026dd1ba8e81c59c1" args="(struct soap *soap, const char *URI, const char *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t soap_wsse_verify_element </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Post-checks the presence of signed element(s). Does not verify the signature of these elements, which is done with <a class="el" href="wsseapi_8c.html#a7321b451910e1d3887b328f03de92f34">soap_wsse_verify_auto</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">URI</td><td>namespace of element(s) </td></tr>
    <tr><td class="paramname">tag</td><td>name of element(s) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of matching elements signed.</dd></dl>
<p>This function does not actually verify the signature of each element, but checks whether the elements are signed and thus their integrity is preserved. Signed element nesting rules are obeyed, so if the matching element is a descendent of a signed element, it is signed as well. Thus, the verification process follows nesting rules.</p>
<p>Client should call this function after invocation. Services should call this function inside a service operation. This function traverses the entire DOM, so performance is determined by the size of a message.</p>
<p>To check the SOAP Body (either using SOAP 1.1 or 1.2), <a class="el" href="wsseapi_8c.html#a3fbe81de521579f026dd1ba8e81c59c1">soap_wsse_verify_element</a>(soap, namespaces[0].ns, "Body"). To check whether the Timestamp was signed (assuming it is present and message expiration checked with <a class="el" href="wsseapi_8c.html#a98422cde0e2b7b14d65212f7061101fa">soap_wsse_verify_Timestamp</a>), use <a class="el" href="wsseapi_8c.html#a3fbe81de521579f026dd1ba8e81c59c1">soap_wsse_verify_element</a>(soap, "http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd", "Timestamp").</p>
<p>Note: for future releases XPath queries (or forms of these) will be considered. </p>

</div>
</div>
<a class="anchor" id="afcfdd54e7c220fb90e11c75da3bbbe88"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_EncryptedKey" ref="afcfdd54e7c220fb90e11c75da3bbbe88" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_EncryptedKey </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the EncryptedKey header information (certificate validity requires soap-&gt;cacert to be set). Retrieves the decryption key from the token handler callback to decrypt the decryption key. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or error code </dd></dl>

</div>
</div>
<a class="anchor" id="a8a246ebd371d9e92c74ec1e29bf92f3a"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_init" ref="a8a246ebd371d9e92c74ec1e29bf92f3a" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_init </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Uses the wsse plugin to initiate the verification of the signature and SignedInfo Reference digests. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK</dd></dl>
<p>This function does not actually verify the message, but initiates the plugin's data to store the message in a DOM to verify the signature. The signature and digests in the DOM must be verified manually. </p>

</div>
</div>
<a class="anchor" id="add4f5148c87d213a69f86c9fc72a8001"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_nested" ref="add4f5148c87d213a69f86c9fc72a8001" args="(struct soap *soap, struct soap_dom_element *dom, const char *URI, const char *tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static size_t soap_wsse_verify_nested </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct soap_dom_element *&#160;</td>
          <td class="paramname"><em>dom</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>URI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>tag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td><code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Counts signed matching elements from the dom node and down. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramname">dom</td><td>node to check and down </td></tr>
    <tr><td class="paramname">URI</td><td>namespace of element(s) </td></tr>
    <tr><td class="paramname">tag</td><td>name of element(s) </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of matching elements. </dd></dl>

</div>
</div>
<a class="anchor" id="aeb0afd01a5036e4f1314a3cfe8575bd5"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_Password" ref="aeb0afd01a5036e4f1314a3cfe8575bd5" args="(struct soap *soap, const char *password)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_Password </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>password</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the supplied password or sets wsse:FailedAuthentication fault. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">password</td><td>string to verify against </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK (authorized) or SOAP_FAULT with wsse:FailedAuthentication fault</dd></dl>
<p>The verification supports both clear-text password verification and digest password authentication. For digest authentication a history mechanism with a digest authentication session database ensures protection against replay attacks. Note: this release supports the use of at most one UsernameToken in the header. </p>

</div>
</div>
<a class="anchor" id="a8ab7e709b0423cd68d3fec96b3db3734"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_SignatureValue" ref="a8ab7e709b0423cd68d3fec96b3db3734" args="(struct soap *soap, int alg, const void *key, int keylen)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_SignatureValue </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>alg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>keylen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the SignatureValue of a SignedInfo element. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alg</td><td>is a signature algorith, such as SOAP_SMD_HMAC_SHA1, SOAP_SMD_VRFY_DSA_SHA1, or SOAP_SMD_VRFY_RSA_SHA1 determined by the SignedInfo/SignatureMethod </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">key</td><td>to use to verify (HMAC or EVP_PKEY) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">keylen</td><td>length of HMAC key </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK, SOAP_EOM, or fault</dd></dl>
<p>This function searches for the SignedInfo element in the soap-&gt;dom DOM tree to verify the signature in the SignatureValue element. Using the DOM ensures we will verify the signature of a SignedInfo as it was exactly received by the parser, by using the -DWITH_DOM compile flag and SOAP_XML_DOM runtime flag. If there is no DOM, it verifies the signature of the deserialized SignedInfo element in the SOAP Header. However, serializing deserialized data may change the octet stream that was signed, unless we're using gSOAP as producers and consumers (with the SOAP_XML_INDENT flag reset). </p>

</div>
</div>
<a class="anchor" id="a75b7ca484637dfc49143546072dd5f4b"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_SignedInfo" ref="a75b7ca484637dfc49143546072dd5f4b" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_SignedInfo </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the digest values of the XML elements referenced by the SignedInfo References. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault</dd></dl>
<p>This function searches for the SignedInfo element in the soap-&gt;dom DOM tree to verify the digests contained therein. Using the DOM ensures we will verify the digests of the locally signed elements as they were exactly received by the parser, by using the -DWITH_DOM compile flag and SOAP_XML_DOM runtime flag. If there is no DOM, the function fails. </p>

</div>
</div>
<a class="anchor" id="a98422cde0e2b7b14d65212f7061101fa"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_Timestamp" ref="a98422cde0e2b7b14d65212f7061101fa" args="(struct soap *soap)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_Timestamp </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies the Timestamp/Expires element against the current time. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">soap</td><td>context </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or SOAP_FAULT with wsse:FailedAuthentication fault</dd></dl>
<p>Sets wsse:FailedAuthentication fault if wsu:Timestamp is expired. The SOAP_WSSE_CLKSKEW value is used as a margin to mitigate clock skew. Keeps silent when no timestamp is supplied or no expiration date is included in the wsu:Timestamp element. </p>

</div>
</div>
<a class="anchor" id="a8f5879e7d5bd3580ea400ccd1982d747"></a><!-- doxytag: member="wsseapi.c::soap_wsse_verify_X509" ref="a8f5879e7d5bd3580ea400ccd1982d747" args="(struct soap *soap, X509 *cert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int soap_wsse_verify_X509 </td>
          <td>(</td>
          <td class="paramtype">struct soap *&#160;</td>
          <td class="paramname"><em>soap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">X509 *&#160;</td>
          <td class="paramname"><em>cert</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Verifies X509 certificate against soap-&gt;cafile, soap-&gt;capath, and soap-&gt;crlfile. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramdir"></td><td class="paramname">soap</td><td>context </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">cert</td><td>X509 certificate </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>SOAP_OK or fault</dd></dl>
<p>This is an expensive operation. Whenever a new soap context is created, the cafile and objects are loaded into that context each time we need to verify a certificate. </p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="a4089697df0f14ecf44cf0fb6098f4f78"></a><!-- doxytag: member="wsseapi.c::c14n_URI" ref="a4089697df0f14ecf44cf0fb6098f4f78" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a4089697df0f14ecf44cf0fb6098f4f78">c14n_URI</a> = &quot;http://www.w3.org/2001/10/xml-exc-c14n#&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a1f62c1715e0f49fd54ffc263e45a12eb"></a><!-- doxytag: member="wsseapi.c::ds_dsa_sha1URI" ref="a1f62c1715e0f49fd54ffc263e45a12eb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a1f62c1715e0f49fd54ffc263e45a12eb">ds_dsa_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#dsa-sha1&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a352a6e78890296ade9e25de397f1096c"></a><!-- doxytag: member="wsseapi.c::ds_hmac_sha1URI" ref="a352a6e78890296ade9e25de397f1096c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a352a6e78890296ade9e25de397f1096c">ds_hmac_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#hmac-sha1&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ab356216a1331e0ba33de2a62d1c8b5fb"></a><!-- doxytag: member="wsseapi.c::ds_hmac_sha256URI" ref="ab356216a1331e0ba33de2a62d1c8b5fb" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#ab356216a1331e0ba33de2a62d1c8b5fb">ds_hmac_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#hmac-sha256&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a73b877c9a2879fcc6bfd311150beccbd"></a><!-- doxytag: member="wsseapi.c::ds_hmac_sha512URI" ref="a73b877c9a2879fcc6bfd311150beccbd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a73b877c9a2879fcc6bfd311150beccbd">ds_hmac_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#hmac-sha512&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad57129724eb01a743b6583afc522a131"></a><!-- doxytag: member="wsseapi.c::ds_rsa_sha1URI" ref="ad57129724eb01a743b6583afc522a131" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#ad57129724eb01a743b6583afc522a131">ds_rsa_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#rsa-sha1&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a739fd4e4c86b17b58877a672bec79bc3"></a><!-- doxytag: member="wsseapi.c::ds_rsa_sha256URI" ref="a739fd4e4c86b17b58877a672bec79bc3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a739fd4e4c86b17b58877a672bec79bc3">ds_rsa_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha256&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6f17cf69547d2ead56934e89f10f3ba6"></a><!-- doxytag: member="wsseapi.c::ds_rsa_sha512URI" ref="a6f17cf69547d2ead56934e89f10f3ba6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a6f17cf69547d2ead56934e89f10f3ba6">ds_rsa_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmldsig-more#rsa-sha512&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a71140ac907117b2bbf37f14939166a15"></a><!-- doxytag: member="wsseapi.c::ds_sha1URI" ref="a71140ac907117b2bbf37f14939166a15" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a71140ac907117b2bbf37f14939166a15">ds_sha1URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#sha1&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a99bf1005a6700b2e94cc400f799f4b93"></a><!-- doxytag: member="wsseapi.c::ds_sha256URI" ref="a99bf1005a6700b2e94cc400f799f4b93" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a99bf1005a6700b2e94cc400f799f4b93">ds_sha256URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#sha256&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a752690ab049714713ae0d240c0a11350"></a><!-- doxytag: member="wsseapi.c::ds_sha512URI" ref="a752690ab049714713ae0d240c0a11350" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a752690ab049714713ae0d240c0a11350">ds_sha512URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#sha512&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ad7aea4af6b24389f66019e8984d4b05c"></a><!-- doxytag: member="wsseapi.c::ds_URI" ref="ad7aea4af6b24389f66019e8984d4b05c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#ad7aea4af6b24389f66019e8984d4b05c">ds_URI</a> = &quot;http://www.w3.org/2000/09/xmldsig#&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a08c28b1011e1b370838312729cca9c01"></a><!-- doxytag: member="wsseapi.c::soap_wsse_id" ref="a08c28b1011e1b370838312729cca9c01" args="[14]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char <a class="el" href="wsseapi_8c.html#a08c28b1011e1b370838312729cca9c01">soap_wsse_id</a>[14] = SOAP_WSSE_ID</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Plugin identification for plugin registry </p>

</div>
</div>
<a class="anchor" id="a777b5d06409128e7bcb97703b4f40f06"></a><!-- doxytag: member="wsseapi.c::soap_wsse_session" ref="a777b5d06409128e7bcb97703b4f40f06" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoap__wsse__session.html">soap_wsse_session</a>* <a class="el" href="structsoap__wsse__session.html">soap_wsse_session</a> = NULL<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>The digest authentication session database </p>

</div>
</div>
<a class="anchor" id="a627ba14d70ad7f79d61e2e93485be6ce"></a><!-- doxytag: member="wsseapi.c::soap_wsse_session_lock" ref="a627ba14d70ad7f79d61e2e93485be6ce" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MUTEX_TYPE <a class="el" href="wsseapi_8c.html#a627ba14d70ad7f79d61e2e93485be6ce">soap_wsse_session_lock</a> = MUTEX_INITIALIZER<code> [static]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Lock for digest authentication session database exclusive access </p>

</div>
</div>
<a class="anchor" id="a7d0ae8f2dd1beaabdaa4884ea5dd41e4"></a><!-- doxytag: member="wsseapi.c::wsse_Base64BinaryURI" ref="a7d0ae8f2dd1beaabdaa4884ea5dd41e4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a7d0ae8f2dd1beaabdaa4884ea5dd41e4">wsse_Base64BinaryURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a000638936fff26e30a3f256c495c1aa8"></a><!-- doxytag: member="wsseapi.c::wsse_PasswordDigestURI" ref="a000638936fff26e30a3f256c495c1aa8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a000638936fff26e30a3f256c495c1aa8">wsse_PasswordDigestURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordDigest&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a38dfc9981f0859b1307c302d8497c08c"></a><!-- doxytag: member="wsseapi.c::wsse_PasswordTextURI" ref="a38dfc9981f0859b1307c302d8497c08c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a38dfc9981f0859b1307c302d8497c08c">wsse_PasswordTextURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a88d310451ae729bbf0fdd149a9d7511c"></a><!-- doxytag: member="wsseapi.c::wsse_X509v3SubjectKeyIdentifierURI" ref="a88d310451ae729bbf0fdd149a9d7511c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a88d310451ae729bbf0fdd149a9d7511c">wsse_X509v3SubjectKeyIdentifierURI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509SubjectKeyIdentifier&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac07968b1c372e976758745ba7089c367"></a><!-- doxytag: member="wsseapi.c::wsse_X509v3URI" ref="ac07968b1c372e976758745ba7089c367" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#ac07968b1c372e976758745ba7089c367">wsse_X509v3URI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="adb66cffe8d95c5d511987189173a993c"></a><!-- doxytag: member="wsseapi.c::wsu_URI" ref="adb66cffe8d95c5d511987189173a993c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#adb66cffe8d95c5d511987189173a993c">wsu_URI</a> = &quot;http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a159d359ac83617f624b54d467db4e0b1"></a><!-- doxytag: member="wsseapi.c::xenc_3desURI" ref="a159d359ac83617f624b54d467db4e0b1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a159d359ac83617f624b54d467db4e0b1">xenc_3desURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#tripledes-cbc&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a289552d8f69933dee3965bb4fc39882b"></a><!-- doxytag: member="wsseapi.c::xenc_aes128URI" ref="a289552d8f69933dee3965bb4fc39882b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a289552d8f69933dee3965bb4fc39882b">xenc_aes128URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes128-cbc&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a04403c472eedb2abd47751086f6a2b37"></a><!-- doxytag: member="wsseapi.c::xenc_aes192URI" ref="a04403c472eedb2abd47751086f6a2b37" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a04403c472eedb2abd47751086f6a2b37">xenc_aes192URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes192-cbc&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a0ab2e6720de47922659747608b9c40e4"></a><!-- doxytag: member="wsseapi.c::xenc_aes256URI" ref="a0ab2e6720de47922659747608b9c40e4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a0ab2e6720de47922659747608b9c40e4">xenc_aes256URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes256-cbc&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a30367bbed5c37ad3d556607aee6e30dd"></a><!-- doxytag: member="wsseapi.c::xenc_aes512URI" ref="a30367bbed5c37ad3d556607aee6e30dd" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a30367bbed5c37ad3d556607aee6e30dd">xenc_aes512URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#aes512-cbc&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="abc58fc5b358c1f06737a623788dbfa0e"></a><!-- doxytag: member="wsseapi.c::xenc_contentURI" ref="abc58fc5b358c1f06737a623788dbfa0e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#abc58fc5b358c1f06737a623788dbfa0e">xenc_contentURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#Content&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a4fdac00892919c46ed53fa05b9cc0bdf"></a><!-- doxytag: member="wsseapi.c::xenc_elementURI" ref="a4fdac00892919c46ed53fa05b9cc0bdf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a4fdac00892919c46ed53fa05b9cc0bdf">xenc_elementURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#Element&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a6c5bdcb80c33d0c3d35050091bd2cec5"></a><!-- doxytag: member="wsseapi.c::xenc_rsa15URI" ref="a6c5bdcb80c33d0c3d35050091bd2cec5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a6c5bdcb80c33d0c3d35050091bd2cec5">xenc_rsa15URI</a> = &quot;http://www.w3.org/2001/04/xmlenc#rsa-1_5&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a43c42203ea88ef920b653d90307e6731"></a><!-- doxytag: member="wsseapi.c::xenc_rsaesURI" ref="a43c42203ea88ef920b653d90307e6731" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* <a class="el" href="wsseapi_8c.html#a43c42203ea88ef920b653d90307e6731">xenc_rsaesURI</a> = &quot;http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sat Aug 18 2012 13:54:15 for gSOAP WS-Security by&#160;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.4 </small></address>
</body>
</html>
